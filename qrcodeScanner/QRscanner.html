<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Code Scanner</title>

  <script src="./node_modules/html5-qrcode/html5-qrcode.min.js"></script>
  <link rel="stylesheet" href="qrstyle.css">
</head>

<body>
  <main class="container">
    <div id="reader"></div>
    <div id="result"></div>
  </main>

  <div class="container">
    <ul id="shopping-list">
    </ul>
    <button id="submit-button" type="submit" style="display: block; width: 100%;">Submit</button>
    <textarea id="text-area" rows="10" cols="50" readonly></textarea>
  </div>

  <div id="processed" class="container"></div>
  <script>

    // console.log(Html5QrcodeScanner);
    const scanner = new Html5QrcodeScanner('reader', {
      // Scanner will be initialized in DOM inside element with id of 'reader'
      qrbox: {
        width: 250,
        height: 250,
      },  // Sets dimensions of scanning box (set relative to reader element width)
      fps: 20, // Frames per second to attempt a scan
    });


    scanner.render(success, error);
    // Starts scanner

    function success(result) {

      document.getElementById('result').innerHTML = `
        <h2>Success!</h2>
        <p><a href="${result}">${result}</a></p>
        `;
      // Prints result as a link inside result element
      console.log(result);
      scanner.clear();
      // Clears scanning instance

      document.getElementById('reader').remove();
      // Removes reader element from DOM since no longer needed
      // return result;
    }

    function error(err) {
      console.error(err);
      // Prints any errors to the console
    }

    $(document).ready(function () {
      $('#inputForm').submit(function (event) {
        event.preventDefault();  // Prevent default form submission

        var formData = $(this).serialize();  // Serialize form data
        $.ajax({
          url: 'http://localhost:5002/get_recipe_from_text',
          type: 'POST',
          data: formData,
          success: function (response) {
            $('#processed_text').text(response.processed_text);
          },
          error: function (error) {
            console.log(error);
          }
        });
      });
    });

  </script>
</body>

</html>